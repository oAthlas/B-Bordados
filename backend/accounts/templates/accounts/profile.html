{% extends 'home/base.html' %}

{% block title %}Perfil{% endblock %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'accounts/profile.css' %}">
{% endblock %}

{% block content %}

<div class="container" style="margin-top: 0px;">

    <!-- SIDEBAR -->
       <nav id="sidebar">
        <div id="sidebar_content">
            <div id="user">
            <img src="{% static 'accounts/' %}{{ customer.avatar | default:'avatar_none' }}.png"
            id="user_avatar" alt="Avatar">
    
                <p id="user_infos">
                    <span class="item-description">
                        {{ user.username }}
                    </span>
                    <span style="color: green;"
                    class="item-description">
                        Online
                    </span>
                </p>
            </div>
    
                <li class="side-item active">
                    <a href="#">
                        <i class="fa-solid fa-user"></i>
                        <span class="item-description">
                            Validação
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'perguntas' %}">
                    <i class="fa-solid fa-bell-concierge"></i>                        <span class="item-description">
                            Suporte
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'my_products' %}">
                        <i class="fa-solid fa-box"></i>
                        <span class="item-description">
                            Produtos
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'home' %}">
                        <i class="fa-solid fa-house"></i>
                        <span class="item-description">
                            Loja
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'settings' %}">
                        <i class="fa-solid fa-gear"></i>
                        <span class="item-description">
                            Configurações
                        </span>
                    </a>
                </li>
            </ul>
    
            <button id="open_btn">
                <i id="open_btn_icon" class="fa-solid fa-chevron-right"></i>
            </button>

        </div>

        <div id="logout">
            <a style="text-decoration: none; color: black;"
            href="{% url 'logout' %}" id="logout_btn">
                <i class="fa-solid fa-right-from-bracket"></i>
                <span class="item-description">
                    Logout
                </span>
            </a>
        </div>
    </nav>
    <!-- CONTEÚDO -->
    <main class="content">
        <h1>Informações de Validação</h1>

        <div class="card">

            <!-- FOTO -->
            <div class="photo-area">
                <div class="photo">
                    <img src="{% static 'accounts/' %}{{ customer.avatar | default:'avatar_none' }}.png" alt="Foto do usuário">
                </div>
                <button class="btn-photo" onclick="openProfileModal()">Alterar foto</button>
            </div>

            <!-- FORM -->
            <form method="post" class="form">
                {% csrf_token %}

                <div class="row">
                    <div class="field">
                        <label class="x">Nome completo</label>
                        <input name="complete_name" value="{{ customer.complete_name }}"
                        {% if locked %}readonly{% endif %}
                        type="text">
                    </div>

                    <div class="field">
                        <label class="x">Celular</label>
                        <input name="phone" value="{{ customer.phone }}"
                        {% if locked %}readonly{% endif %}
                        type="number" placeholder="(yy) xxxxx-xxxx">
                    </div>
                </div>

                <div class="row">
                    <div class="field">
                        <label class="x">CPF</label>
                        <input name="cpf" value="{{ customer.cpf }}"
                        {% if locked %}readonly{% endif %}
                        type="number" placeholder="xxx.xxx.xxx-yy">
                    </div>

                    <div class="field">
                        <label class="x">E-mail</label>
                        <input name="email" value="{{ user.email }}"
                        {% if locked %}readonly{% endif %}
                        type="email" placeholder="usuário@exemple.com">
                    </div>
                </div>

                <div class="row">
                    <div class="field">
                        <label>Data de nascimento</label>
                        <div class="date">
                            <input name="birth_day"
                            value="{% if customer.birth_date %}{{ customer.birth_date.day }}{% endif %}"
                            type="number"
                            {% if locked %}readonly{% endif %}
                            placeholder="DD">
                            <input name="birth_month"
                            value="{% if customer.birth_date %}{{ customer.birth_date.month }}{% endif %}"
                            type="number"
                            {% if locked %}readonly{% endif %}
                            placeholder="MM">
                            <input name="birth_year"
                            value="{% if customer.birth_date %}{{ customer.birth_date.year }}{% endif %}"
                            type="number"
                            {% if locked %}readonly{% endif %}
                            placeholder="AAAA">
                        </div>
                    </div>

                    <div class="field align-end">
                        {% if not locked %}
                            <button type="submit" class="btn-save">Salvar alterações</button>
                        {% else %}
                            <button type="submit" class="btn-save">Seus dados já foram salvos</button>
                            {% if loacked %}disabled{% endif %}
                        {% endif %}
                    </div>
                </div>

                <div class="gender">
                    <label><input type="radio" name="gender" value="M" 
                        {% if customer.gender == 'M' %}checked{% endif %}
                        {% if locked %}disabled{% endif %}>
                        Masculino</label>
                    <label><input type="radio" name="gender" value="F" 
                        {% if customer.gender == 'F' %}checked{% endif %}
                        {% if locked %}disabled{% endif %}>
                        Feminino</label>
                </div>
            </form>
        </div>
    </main>
</div>

<!-- BOTÃO PARA ABRIR (exemplo) -->

<!-- MODAL -->
<div class="profile-modal" id="profileModal">

<form method="post" action="{% url 'change_avatar' %}">
    {% csrf_token %}
    <div class="profile-modal-content">

        <button class="profile-modal-close" onclick="closeProfileModal()">×</button>

        <h2>Escolha sua foto de perfil</h2>
        <input type="hidden" name="avatar" id="selectedAvatar">

        <!-- PREVIEW PRINCIPAL -->
        <div class="profile-preview">
            <img id="profilePreview" src="{% static 'accounts/' %}{{ customer.avatar | default:'avatar_none' }}.png" alt="Preview do avatar">
        </div>

        <!-- SUGESTÕES -->
        <div class="profile-suggestions">
            <img src="{% static 'accounts/avatar_1.png' %}" data-avatar="avatar_1" onclick="selectAvatar(this)">
            <img src="{% static 'accounts/avatar_2.png' %}" data-avatar="avatar_2" onclick="selectAvatar(this)">
            <img src="{% static 'accounts/avatar_3.png' %}" data-avatar="avatar_3" onclick="selectAvatar(this)">
            <img src="{% static 'accounts/avatar_4.png' %}" data-avatar="avatar_4" onclick="selectAvatar(this)">
            <img src="{% static 'accounts/avatar_5.png' %}" data-avatar="avatar_5" onclick="selectAvatar(this)">
            <img src="{% static 'accounts/avatar_6.png' %}" data-avatar="avatar_6" onclick="selectAvatar(this)">
        </div>

        <!-- AÇÕES -->
        <div class="profile-actions">
            <button type="button" class="cancel" onclick="closeProfileModal()">Cancelar</button>
            <button type="submit" class="save">Salvar</button>
        </div>

    </div>
</form>
</div>
{% endblock %}