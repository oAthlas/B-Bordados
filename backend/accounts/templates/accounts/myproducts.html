{% extends 'home/base.html' %}

{% block title %}Meus Pedidos{% endblock %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'accounts/myproducts.css' %}">
{% endblock %}

{% block content %}
<div class="container" style="margin-top: 0px;">
    <!-- SIDEBAR -->
       <nav id="sidebar">
        <div id="sidebar_content">
            <div id="user">
            <img src="{% static 'accounts/' %}{{ request.user.customer.avatar | default:'avatar_none' }}.png" 
            id="user_avatar" alt="Avatar">
    
                <p id="user_infos">
                    <span class="item-description">
                        {{ user.username }}
                    </span>
                    <span style="color: green;"
                    class="item-description">
                        Online
                    </span>
                </p>
            </div>
    
                <li class="side-item">
                    <a href="{% url 'profile' %}">
                        <i class="fa-solid fa-user"></i>
                        <span class="item-description">
                            Validação
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'perguntas' %}">
                    <i class="fa-solid fa-bell-concierge"></i>                        <span class="item-description">
                            Suporte
                        </span>
                    </a>
                </li>
    
                <li class="side-item active">
                    <a href="{% url 'my_products' %}">
                        <i class="fa-solid fa-box"></i>
                        <span class="item-description">
                            Produtos
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'home' %}">
                        <i class="fa-solid fa-house"></i>
                        <span class="item-description">
                            Loja
                        </span>
                    </a>
                </li>
    
                <li class="side-item">
                    <a href="{% url 'settings' %}">
                        <i class="fa-solid fa-gear"></i>
                        <span class="item-description">
                            Configurações
                        </span>
                    </a>
                </li>
            </ul>
    
            <button id="open_btn">
                <i id="open_btn_icon" class="fa-solid fa-chevron-right"></i>
            </button>

        </div>

        <div id="logout">
            <a style="text-decoration: none; color: black;"
            href="{% url 'logout' %}" id="logout_btn">
                <i class="fa-solid fa-right-from-bracket"></i>
                <span class="item-description">
                    Logout
                </span>
            </a>
        </div>
    </nav>

<section class="meus-pedidos">

  <h2>Meus Pedidos</h2>

{% if products %}
  {% for product in products %}
    <div class="pedido-card">

      <img class="pedido-img"
           src="{{ product.image.url }}"
           alt="{{ product.name }}">

      <div class="pedido-info">
        <h3>{{ product.name }}</h3>

        <ul class="pedido-status">
          <li class="status done">
            <span class="radio"></span>
            Pedido Realizado
          </li>

          <li class="status {% if product.is_paid %}done{% endif %}">
            <span class="radio"></span>
            Pagamento Confirmado
          </li>

          <li class="status {% if product.is_paid %}active{% endif %}">
            <span class="radio"></span>
            Download Liberado
          </li>
        </ul>

        {% if product.is_paid %}
          <a href="{% url 'download_product' product.id %}"
          style="text-decoration: none; text-align: center;"
           class="btn-download">
            Pronto para Download
          </a>
        {% else %}
          {% if product.pending_payment_url %}
          <a href="{{ product.pending_payment_url }}" class="aguardando">
            Aguardando pagamento
          </a>
          {% else %}
          <span class="aguardando">
            Aguardando pagamento
          </span>
          {% endif %}
        {% endif %}
      </div>

    </div>
  {% endfor %}
{% else %}
  <p class="nenhum-pedido">Você ainda não possui produtos.</p>
{% endif %}

</section>


</div>    
{% endblock %}